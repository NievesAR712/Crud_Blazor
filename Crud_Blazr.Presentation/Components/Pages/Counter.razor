@page "/counter"
@using Crud_Blazr.Core.Models
@using Crud_Blazr.Application.Services
@using System.Diagnostics

@inject UserService UserService
@inject NavigationManager Navigation

<h3>Agregar Nuevo Usuario</h3>

<EditForm Model="@newUser" OnValidSubmit="HandleValidSubmit">
    <DataAnnotationsValidator />
    <ValidationSummary />

    <div>
        <label for="name">Nombre:</label>
        <InputText id="name" class="form-control" @bind-Value="newUser.Name" />
    </div>

    <div>
        <label for="email">Correo Electrónico:</label>
        <InputText id="email" class="form-control" @bind-Value="newUser.Email" />
    </div>

    <div>
        <label for="phone">Teléfono:</label>
        <InputText id="phone" class="form-control" @bind-Value="newUser.Phone" />
    </div>

    <div>
        <label for="password">Contraseña:</label>
        <InputText id="password" class="form-control" @bind-Value="newUser.Password" />
    </div>

    <div>
        <button type="submit" class="btn btn-primary">Agregar Usuario</button>
    </div>
</EditForm>

@code {
    private Usuario newUser = new Usuario();
    // Esta es la lista de usuarios. En una aplicación real, podría provenir de una base de datos o un servicio.
    private List<Usuario> users = new List<Usuario>();
    private async Task HandleValidSubmit()
    {
        try
        {
            await UserService.AddUserAsync(newUser);
            Navigation.NavigateTo("/");
        }
        catch (Exception ex)
        {
            Debug.WriteLine($"Error al agregar usuario: {ex.Message}");
        }
    }

    

}